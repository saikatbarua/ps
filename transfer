# Path to the Excel file
$excelFilePath = "C:\path\to\your\file.xlsx"

# Open Excel Application
$excel = New-Object -ComObject Excel.Application
$excel.Visible = $false

# Open the workbook
$workbook = $excel.Workbooks.Open($excelFilePath)

# Select the first worksheet
$worksheet = $workbook.Sheets.Item(1)

# Find the last row with data
$lastRow = $worksheet.Cells.Item($worksheet.Rows.Count, 1).End(-4162).Row

# Loop through the rows
for ($row = 1; $row -le $lastRow; $row++) {
    $xValue = $worksheet.Cells.Item($row, 1).Value2

    if ($xValue -eq 1 -or $xValue -eq 3) {
        # Update the corresponding "y" value to "orange"
        $worksheet.Cells.Item($row, 2).Value2 = "orange"
    }
}

# Save and close the workbook
$workbook.Save()
$workbook.Close()
$excel.Quit()

# Release the COM objects
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($worksheet) | Out-Null
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($workbook) | Out-Null
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($excel) | Out-Null

# Garbage Collection
[System.GC]::Collect()
[System.GC]::WaitForPendingFinalizers()

Write-Host "Values updated successfully!"
